# HTTP协议

### 含义

> HTTP（Hyper Text Transfer Protocol）协议是超文本传输协议的缩写，它是从WEB服务器传输超文本标记语言(HTML)到本地浏览器的传送协议，位于 OSI 网络模型中的应用层。
>
> HTTP 是一个基于TCP/IP通信协议来传递数据的协议，传输的数据类型为 HTML 文件、图片文件、查询结果等。
> 
> HTTP协议一般用于 B/S 架构。浏览器作为 HTTP 客户端通过 URL 向 HTTP 服务端即 WEB 服务器发送所有请求。

### HTTP 特点
HTTP 协议支持客户端/服务端模式，也是一种请求/响应模式的协议
- 简单快速： 客户向服务器请求服务时，只需传送请求方法和路径。请求方法常用的有GET、HEAD、POST
- 灵活： HTTP允许传输任意类型的数据对象。传输的类型由Content-Type加以标记。
- 无连接： 限制每次连接只处理一个请求。服务器处理完请求，并收到客户的应答后，即断开连接，但是却不利于客户端与服务器保持会话连接，为了弥补这种不足，产生了两项记录http状态的技术，一个叫做Cookie,一个叫做Session。
- 无状态： 无状态是指协议对于事务处理没有记忆，后续处理需要前面的信息，则必须重传。

### HTTP中间人攻击

HTTP 协议使用起来确实非常的方便，但是它存在一个致命的缺点：不安全。

我们知道 HTTP 协议中的报文都是以明文的方式进行传输，不做任何加密，这样会导致中间人攻击

#### 如何防止中间人攻击
既然 HTTP 是明文传输，那我们家加密不就好了
- 对称加密  
对称加密 很好理解，即加密和解密使用的同一个密钥，是 对称 的。只要保证了密钥的安全，那整个通信过程就可以说具有了机密性。
缺点： 这种加密方式固然很好，但是问题就在于如何让双方知道秘钥，术语叫“密钥交换”。因为传输数据都是走的网络，如果将秘钥通过网络的方式传递的话，一旦秘钥被截获就没有加密的意义的。
- 非对称加密
也叫公钥加密算法，它有两个密钥，一个叫 公钥（public key），一个叫 私钥（private key）。两个密钥是不同的，不对称，公钥可以公开给任何人使用，而私钥必须严格保密。

公钥和私钥有个特别的 单向 性，虽然都可以用来加密解密，但公钥加密后只能用私钥解密，反过来，私钥加密后也只能用公钥解密。

**非对称加密可以解决 密钥交换 的问题。网站秘密保管私钥，在网上任意分发公钥，你想要登录网站只要用公钥加密就行了，密文只能由私钥持有者才能解密。而黑客因为没有私钥，所以就无法破解密文。**

这种加密方式就可以完美解决对称加密存在的问题。假设现在两端需要使用对称加密，那么在这之前，可以先使用非对称加密交换秘钥。

简单流程如下：首先服务端将公钥公布出去，那么客户端也就知道公钥了。接下来客户端创建一个秘钥，然后通过公钥加密并发送给服务端，服务端接收到密文以后通过私钥解密出正确的秘钥，这时候两端就都知道秘钥是什么了。

那么这样做就是绝对安全了吗？

所谓道高一尺魔高一丈，中间人为了对应这种加密方法又想出了一个新的破解方案，既然拿不到 私钥 ，那我就把自己模拟成一个客户端和服务器端的结合体，在 用户->中间人 的过程中，中间人模拟服务器的行为 ，这样可以拿到用户请求的明文，在 中间人->服务器 的过程中中间人模拟客户端行为，这样可以拿到服务器响应的明文，以此来进行中间人攻击

这一次通信再次被中间人截获，中间人自己也伪造了一对公私钥，并将公钥发送给用户以此来窃取客户端生成的 私钥 ，在拿到 私钥 之后就能轻松的进行解密了。

还是没有彻底解决中间人攻击问题，怎么办喃？接下来我们看看 HTTPS 是怎么解决通讯安全问题的。



